Cacti受信ノードのHA化
---------------------

構成概要
^^^^^^^^
HA化ポリシー
~~~~~~~~~~~~

既設のCacitサーバの IP を VIP に変更する

keepalived で VIP を冗長化する

オンプレマスター・スレーブ構成。スレーブノードを新たに追加する

冗長化する機能
~~~~~~~~~~~~~~

* Apache/Tomcat でエージェントから性能データzipを受信する機能
* RSyncで受信データをCacitサービスノードに転送する機能

事前準備
^^^^^^^^

スレーブノードの基本モジュールセットアップ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スタンドアロン構成での基本モジュールセットアップ

マスターノード、スレーブノードでRSync送信ができるようにする
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

RSyncインストール
RSync接続設定
RSync動作確認

スレーブノードの Apache をVIPでサービス受信できるようにする
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Apacheの受信IPをVIPに設定変更

VIPは現マスターノードのIPとする

マスターノードの物理IPとVIPのネットワーク切替
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ネットワークスクリプトの編集

::

   ifcfg-eth0
   ifcfg-eth0:1
    70-persistent-net.rules

ネットワークサービス再起動

keepalivedによるマスターノード、スレーブノードの VIP 切替設定
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Webサービス死活監視スクリプト動作確認

keepalivedインストール

keepalived の VIP設定

keepalived 再起動
