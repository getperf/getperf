ZabbixのHA化
------------

構成概要
^^^^^^^^

HA化ポリシー
~~~~~~~~~~~~

既設のZabbixサーバの IPをVIPに変更する

MHAでMySQLデータベースの冗長化をする

オンプレ。マスター・スレーブ構成

冗長化する機能
~~~~~~~~~~~~~~

MySQL
Zabbix

事前準備
^^^^^^^^

スタンドアロン構成での基本モジュールセットアップ

マスター、スレーブノードの接続設定

::

   root の ssh 公開鍵の配布
   MySQL 監視用のユーザ作成

CactiサービスノードのZABBIX宛先を VIP に設定

マスターノードの物理IPとVIPのネットワーク切替
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

スレーブノードをVIPで受信できるようにする
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

スレーブノードのZabbixのサービス停止

Zabbixの受信IPをVIPに設定変更

MySQLレプリケーションセットアップ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

MySQL 設定ファイル編集

マスターノードのMySQLデータバックアップ

スレーブるノードのMySQLデータリストア

MySQLレプリケーション設定

MySQLレプリケーション　動作確認

MHAセットアップ
^^^^^^^^^^^^^^^

MHAインストール

MHA拡張スクリプトセットアップ

MHA設定ファイルの編集

MHAサービス起動

フェイルオーバーテスト
