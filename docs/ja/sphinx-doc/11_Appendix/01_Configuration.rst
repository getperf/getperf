
設定ファイルの定義
=============

**cre_config.pl** コマンドにて$GETPERF_HOME/confの下に各設定ファイルが生成されます。
これら設定はインストール作業時に

getperf_site.json
-----------------

Getperf のベース設定と、各種インストールソフトウェアのプロパティ設定を行います。Getperf ホームディレクトリ、ログ出力設定をします。

+-------------------------------+-------------------------------+-------------------------------------------------------------------------------------------+
|項目名                         |既定値                         |定義                                                                                       |
+===============================+===============================+===========================================================================================+
|GETPERF_HOME                   |COMPONENT_ROOT                 |Getperfのホームディレクトリ。デフォルトは管理ユーザのホームディレクトリの下のgetperf       |
+-------------------------------+-------------------------------+-------------------------------------------------------------------------------------------+
|GETPERF_SITE_DIR               |COMPONENT_ROOT/t               |ユニットテスト用サイトディレクトリ                                                         |
+-------------------------------+-------------------------------+-------------------------------------------------------------------------------------------+
|GETPERF_STAGING_DIR            |COMPONENT_ROOT/t/staging_data  |ユニットテスト用グラフデータディレクトリ                                                   |
+-------------------------------+-------------------------------+-------------------------------------------------------------------------------------------+
|GETPERF_TMPFS_DIR              |/tmp                           |RRDtoolのデータキャッシュディレクトリ                                                      |
+-------------------------------+-------------------------------+-------------------------------------------------------------------------------------------+
|GETPERF_LOG_DIR                |COMPONENT_ROOT/log             |ログ出力ディレクトリ                                                                       |
+-------------------------------+-------------------------------+-------------------------------------------------------------------------------------------+
|GETPERF_LOG_LEVEL              |notice                         |デーモンプロセスのログレベル。debug,info,notice,warn,err,crit から選択                     |
+-------------------------------+-------------------------------+-------------------------------------------------------------------------------------------+
|GETPERF_STDOUT_LOG_LEVEL       |notice                         |コマンド実行のログレベル。debug,info,notice,warn,err,crit から選択                         |
+-------------------------------+-------------------------------+-------------------------------------------------------------------------------------------+
|GETPERF_DISK_UTIL_LIMIT_MB     |100                            |ディスク容量アラームの閾値(MB)。ディスク空き容量が本値を下回ると致命的エラーで終了します   |
+-------------------------------+-------------------------------+-------------------------------------------------------------------------------------------+

Redis サーバのキュー設定を行います。クラスター構成のノード間の通信に使用します。

+-----------------------+-----------------------+-----------------------+
|項目名                 |既定値                 |定義                   |
+=======================+=======================+=======================+
|GETPERF_REDIS_PORT     |6379                   |Redis サービスポート   |
+-----------------------+-----------------------+-----------------------+
|GETPERF_REDIS_HOST     |localhost              |Redis サービスホスト   |
+-----------------------+-----------------------+-----------------------+
|GETPERF_QUEUE          |getperf:queue:default  |Redis キュー名         |
+-----------------------+-----------------------+-----------------------+

MySQL のパスワード、SSL証明書の設定をします。

+-----------------------------------+-------------------+-----------------------------------+
|項目名                             |既定値             |定義                               |
+===================================+===================+===================================+
|GETPERF_CACTI_MYSQL_ROOT_PASSWD    |getperf            |MySQLのルートパスワード            |
+-----------------------------------+-------------------+-----------------------------------+
|GETPERF_ADMIN_SSL_DIR              |/etc/getperf/ssl   |SSL証明書ディレクトリ              |
+-----------------------------------+-------------------+-----------------------------------+
|GETPERF_SSL_EXPIRATION_DAY         |365                |SSL証明書有効期限。日数を指定      |
+-----------------------------------+-------------------+-----------------------------------+
|GETPERF_LICENSE_POLICY             |none               |ライセンスポリシー(現在はnoneのみ) |
+-----------------------------------+-------------------+-----------------------------------+

エージェント Webサービスの設定で、Apache HTTP サーバと、Tomcat Webコンテナの設定をします。Apache, Tomcat の Web　サービスは 管理用の admin と、データ通信用の data の 2つで構成します。初めに管理用 Web サービス設定をします。

+-------------------------------+-------------------------------+-----------------------------------------------+
|項目名                         |既定値                         |定義                                           |
+===============================+===============================+===============================================+
|GETPERF_WS_TOMCAT_OWNER        |${admin_user}                  |エージェントWebサービスプロセスオーナー        |
+-------------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_SERVER_NAME         |${local_ip}                    |廃止。エージェントWebサービスホスト            |
+-------------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_SERVER_ADMIN        |you@example.com                |エージェントWebサービス管理者連絡先            |
+-------------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_PROTOCOL            |https                          |httpまたはhttps                                |
+-------------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_ADMIN_SUFFIX        |admin                          |インストールディレクトリのサフィックス。       |
|                               |                               |tomcat-{suffix}となる                          |
+-------------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_ADMIN_SERVER        |${local_ip}                    |サーバ名                                       |
+-------------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_ADMIN_PORT_SSL      |57443                          |Apache HTTPSポート                             |
+-------------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_ADMIN_PORT_RUN      |57005                          |Tomcat 管理ポート                              |
+-------------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_ADMIN_PORT_AJP      |57009                          |Apache AJPポート                               |
+-------------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_ADMIN_PORT          |57000                          |Apache HTTPポート                              |
+-------------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_ADMIN_DIR           |/axis2/services/GetperfService |エージェントWebサービス URL                    |
+-------------------------------+-------------------------------+-----------------------------------------------+

データ通信用 Apache, Tomcat Web サービス設定をします。

+---------------------------+-------------------------------+-----------------------------------------------+
|項目名                      |既定値                        |定義                                           |
+===========================+===============================+===============================================+
|GETPERF_WS_DATA_SUFFIX     |data                           |インストールディレクトリのサフィックス。       |
|                           |                               |tomcat-{suffix}となる                          |
+---------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_DATA_SERVER     |${local_ip}                    |Webサービスホスト                              |
+---------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_DATA_PORT_SSL   |58443                          |Apache HTTPS ポート                            |
+---------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_DATA_PORT_RUN   |58005                          |Tomcat 管理ポート                              |
+---------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_DATA_PORT_AJP   |58009                          |Apache AJP ポート                              |
+---------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_DATA_PORT       |58000                          |Apache HTTPポート                              |
+---------------------------+-------------------------------+-----------------------------------------------+
|GETPERF_WS_DATA_DIR        |/axis2/services/GetperfService |インストールディレクトリサフィックス           |
+---------------------------+-------------------------------+-----------------------------------------------+

Apache, Tomcat Webサービスの共通設定をします。

+---------------------------+-------------------+------------------------------------+
|項目名                     |既定値             |定義                                |
+===========================+===================+====================================+
|GETPERF_WS_APACHE_HOME     |/usr/local/apache  | Apache インストールディレクトリ    |
+---------------------------+-------------------+------------------------------------+
|GETPERF_WS_TOMCAT_HOME     |/usr/local/tomcat  | Tomcat インストールディレクトリ    |
+---------------------------+-------------------+------------------------------------+
|GETPERF_WS_MAX_SERVERS     |30                 | Tomcat 最大スレッド数(現在未使用)  |
+---------------------------+-------------------+------------------------------------+
|GETPERF_WS_TIMEOUT         |30                 | Tomcat タイムアウト秒(現在未使用)  |
+---------------------------+-------------------+------------------------------------+
|GETPERF_WS_WAIT_TIME       |60                 | 現在未使用                         |
+---------------------------+-------------------+------------------------------------+

エージェントデータ転送で転送されたzipファイルの設定をします。

+-------------------------------+-------+-------------------------------------------+
|項目名                         |既定値 |定義                                       |
+===============================+=======+===========================================+
|GETPERF_ZIP_PURGE_ENABLE       |TRUE   | 過去のzipファイルの消込処理を有効にするか |
+-------------------------------+-------+-------------------------------------------+
|GETPERF_ZIP_RETENTION_HOUR     |1      | 過去のzipファイルの保存期間(時間)         |
+-------------------------------+-------+-------------------------------------------+
|GETPERF_ZIP_PURGE_HOUR         |3      | 過去のzipファイルの削除期間(時間)         |
+-------------------------------+-------+-------------------------------------------+

エージェントモジュールの配置、バージョンの設定をします。

+-------------------------------+---------------------------+--------------------------------------------------------------+
|項目名                          |既定値                    |定義                                                          |
+===============================+===========================+==============================================================+
|GETPERF_AGENT_TAR              |COMPONENT_ROOT/var/agent   | エージェントモジュールダウンロードサイトのホームディレクトリ |
+-------------------------------+---------------------------+--------------------------------------------------------------+
|GETPERF_AGENT_MAJOR_VERSION    |2                          | エージェントのメジャーバージョン                             |
+-------------------------------+---------------------------+--------------------------------------------------------------+

集計データの保持期間を設定します。

+----------------------------+------------------+------------------------------------------------------------------------------+
|項目名                       |既定値           |定義                                                                          |
+============================+==================+==============================================================================+
|GETPERF_PURGE_DATA_HOUR     |"analysis": 3     | zip解凍したエージェント受信データの保存ディレクトリ anlysis の保持期間(時間) |
+----------------------------+------------------+------------------------------------------------------------------------------+
|GETPERF_PURGE_DATA_HOUR     |"summary": 3      | 集計データの保存ディレクトリ summary の保持期間(時間)                        |
+----------------------------+------------------+------------------------------------------------------------------------------+

getperf_cacti.json
------------------

グラフモニタリングツール Cacti の配置、バージョンの設定をします。

+---------------------------+-------------------------------+---------------------------------------------------------------------------------------------+
|項目名                      |既定値                            |定義                                                                                     |
+===========================+===============================+=============================================================================================+
|GETPERF_CACTI_HTML         |/var/www/html                  | Cacti ホームのルートディレクトリ。各サイトのCacti ホームは本ディレクトリの下にリンクされる  |
+---------------------------+-------------------------------+---------------------------------------------------------------------------------------------+
|GETPERF_CACTI_ARCHIVE_DIR  |[%COMPONENT_ROOT%]/var/cacti   | Cacti モジュールアーカイブの保存先                                                          |
+---------------------------+-------------------------------+---------------------------------------------------------------------------------------------+
|GETPERF_CACTI_ARCHIVE      |cacti-0.8.8g.tar.gz            | Cacti モジュールアーカイブのファイル名                                                      |
+---------------------------+-------------------------------+---------------------------------------------------------------------------------------------+
|GETPERF_CACTI_HOME         |[%COMPONENT_ROOT%]/lib/cacti   | 各さーびの Cacti ホームディレクトリ                                                         |
+---------------------------+-------------------------------+---------------------------------------------------------------------------------------------+
|GETPERF_CACTI_TEMPLATE_DIR |template/0.8.8g                | Cacti テンプレートの保存先                                                                  |
+---------------------------+-------------------------------+---------------------------------------------------------------------------------------------+
|GETPERF_CACTI_DUMP         |template/0.8.8g/cacti.dmp      | Cacti リポジトリデータベースのダンプファイル                                                |
+---------------------------+-------------------------------+---------------------------------------------------------------------------------------------+
|GETPERF_CACTI_CONFIG       |template/config.php.tpl        | Cacti 設定ファイルのテンプレートの保存先                                                    |
+---------------------------+-------------------------------+---------------------------------------------------------------------------------------------+

getperf_rrd.json
----------------

時系列データベース RRDtool のリテンション、集計期間の設定をします。

+-----------+-------+---------------------------------------------------------------------------+
|項目名     |既定値 |定義                                                                       |
+===========+=======+===========================================================================+
|label      |Dayly  | 直近1日のグラフを参照するときの設定。以下、step,save_daysの設定に従います |
+-----------+-------+---------------------------------------------------------------------------+
|step       |120    | 集計期間(秒)                                                              |
+-----------+-------+---------------------------------------------------------------------------+
|save_days  |1      | データ保持期間(日)                                                        |
+-----------+-------+---------------------------------------------------------------------------+
|label      |Weekly | 直近1週間のグラフを参照するときの設定                                     |
+-----------+-------+---------------------------------------------------------------------------+
|step       |900    | 集計期間(秒)                                                              |
+-----------+-------+---------------------------------------------------------------------------+
|save_days  |8      | データ保持期間(日)                                                        |
+-----------+-------+---------------------------------------------------------------------------+
|label      |Monthly| 直近1カ月のグラフを参照するときの設定                                     |
+-----------+-------+---------------------------------------------------------------------------+
|step       |3600   | 集計期間(秒)                                                              |
+-----------+-------+---------------------------------------------------------------------------+
|save_days  |31     | データ保持期間(日)                                                        |
+-----------+-------+---------------------------------------------------------------------------+
|label      |Yearly | 直近1年のグラフを参照するときの設定                                       |
+-----------+-------+---------------------------------------------------------------------------+
|step       |86400  | 集計期間(秒)                                                              |
+-----------+-------+---------------------------------------------------------------------------+
|save_days  |730    | データ保持期間(日)                                                        |
+-----------+-------+---------------------------------------------------------------------------+

getperf_rsync.json
------------------

別サーバのエージェント転送データをフォワードするときの設定で、特定サイトのデータを別サーバに複製するときに使用します。また、旧パージョン(V1)のサイトを現バージョン(V2)に移行する際に使用します。本設定はオプションとなり、デフォルトは無効となります。設定の詳細については、[旧バージョンのサイトの移行](docs/ja/docs/10_Miscellaneous/02_PotingOldVersion.md)を参照してください

+---------------------------+-------------------+-------------------------------------------+
|項目名                      |既定値            |定義                                       |
+===========================+===================+===========================================+
|GETPERF_RSYNC_SOURCE       |staging_data/site  | RSync ソース名                            |
+---------------------------+-------------------+-------------------------------------------+
|GETPERF_RSYNC_ZIP_KEYWORD  |                   | データ転送ファイルのキーワードフィルター  |
+---------------------------+-------------------+-------------------------------------------+
|GETPERF_RSYNC_HOST         |localhost          | データ転送基のホスト                      |
+---------------------------+-------------------+-------------------------------------------+

getperf_zabbix.json
-------------------

オープンソースの統合監視ソフト Zabbix の設定をします。本設定はオプションで、デフォルトは無効となります。

+---------------------------+---------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+
|項目名                     |既定値                                                                                             |定義                                                               |
+===========================+===================================================================================================+===================================================================+
|ZABBIX_SERVER_VERSION      |2.2.9                                                                                              | Zabbix サーババージョン                                           |
+---------------------------+---------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+
|ZABBIX_REPOSITORY_URL      |http://repo.zabbix.com/zabbix/2.2/rhel/6/x86_64/zabbix-release-2.2-1.el6.noarch.rpm                | Zabbix YUMリポジトリのURL                                         |
+---------------------------+---------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+
|ZABBIX_AGENT_VERSION       |2.2.9                                                                                              | Zabbix エージェントバージョン                                     |
+---------------------------+---------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+
|DOWNLOAD_AGENT_PLATFORMS   |"linux2_4.i386", "linux2_6.i386", "linux2_6.amd64", "solaris10.sparc", "solaris10.amd64", "win"    | Zabbix エージェントモジュールをダウンロードするプラットフォーム   |
+---------------------------+---------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+
|ZABBIX_AGENT_DOWNLOAD_DIR  |[% COMPONENT_ROOT %]/var/agent                                                                     | Zabbix エージェントモジュールのダウンロード先                     |
+---------------------------+---------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+
|ZABBIX_SERVER_IP           |[% ZABBIX_SERVER_IP %]                                                                             | Zabbi サーバの IP アドレス                                        |
+---------------------------+---------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+
|ZABBIX_ADMIN_PASSWORD      |ZABBIX_ADMIN_PASSWORD                                                                              | Zabbix リポジトリデータベースの root パスワード                   |
+---------------------------+---------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+
|USE_ZABBIX_MULTI_SIZE      |0                                                                                                  | 1つのZabbixインスタンスで複数のサイトを管理する場合に有効化します |
+---------------------------+---------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+
|GETPERF_AGENT_USE_ZABBIX   |0                                                                                                  | Zabbixによる監視を有効にするか                                    |
+---------------------------+---------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+


getperf_graphite.json
---------------------

オープンソースの時系列データベース Graphite の設定をします。本設定はオプションで、デフォルトは無効となります。

+---------------------+--------------------------+-----------------------------------------------+
|項目名               |既定値                    |定義                                           |
+=====================+==========================+===============================================+
|GRAPHITE_SECRET_KEY  |[% GRAPHITE_SECRET_KEY %] | Graphite のシークレットキー                   |
+---------------------+--------------------------+-----------------------------------------------+
|GRAPHITE_TIME_ZONE   |Asia/Tokyo                | Graphite のタイムゾーン                       |
+---------------------+--------------------------+-----------------------------------------------+
|GRAPHITE_DB          |graphite                  | Graphite 管理データベース名                   |
+---------------------+--------------------------+-----------------------------------------------+
|GRAPHITE_WEB_PORT    |8081                      | Graphite-web の HTTP接続ポート                |
+---------------------+--------------------------+-----------------------------------------------+
|GRAPHITE_DB_USER     |graphite                  | Graphite 管理データベースのユーザ             |
+---------------------+--------------------------+-----------------------------------------------+
|GRAPHITE_DB_PASS     |[% GRAPHITE_DB_PASS %]    | Graphite 管理データベースのユーザのパスワード |
+---------------------+--------------------------+-----------------------------------------------+
|GRAPHITE_LOADER_HOST |127.0.0.1                 | Graphite のロード先                           |
+---------------------+--------------------------+-----------------------------------------------+
|GRAPHITE_LOADER_PORT |2003                      | Graphite ロード用ポート                       |
+---------------------+--------------------------+-----------------------------------------------+
|GETPERF_USE_GRAPHITE |0                         | Graphite によるデータ蓄積を有効にするか       |
+---------------------+--------------------------+-----------------------------------------------+

getperf_influx.json
---------------------

オープンソースの時系列データベース InfluxDB の設定をします。本設定はオプションで、デフォルトは無効となります。

+---------------------+--------------------------+-----------------------------------------------+
|項目名               |既定値                    |定義                                           |
+=====================+==========================+===============================================+
|INFLUX_CLI           |/opt/influxdb/influx      |InfluxDB CLI の実行パス                        |
+---------------------+--------------------------+-----------------------------------------------+
|INFLUX_HOST          |localhost                 |InfluxDB のロード先                            |
+---------------------+--------------------------+-----------------------------------------------+
|INFLUX_PORT          |8086                      |InfluxDB ロード用ポート                        |
+---------------------+--------------------------+-----------------------------------------------+
|VAR_LIB_INFLUXDB     |/var/lib/influxdb         |InfluxDB データファイル保存ディレクトリ        |
+---------------------+--------------------------+-----------------------------------------------+
|GETPERF_USE_INFLUXDB |0                         |InfluxDB によるデータ蓄積を有効にするか        |
+---------------------+--------------------------+-----------------------------------------------+

