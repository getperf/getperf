first
========

You wrote the graph registration procedure of visualization tool Cacti in this chapter. Already data totaling assumption is made, then the assumed that a node definition file was generated.
Procedure of graph registration will be following.

.. Figure :: ../image/cacti_flow.png
   : Align: center
   : Alt: Cacti Flow

   Cacti Flow

Creating a template 1. Cacti

  Based on the graph definition file to create a model of the graph layout. Cacti host templates, chart template, you create a data source template.
  These templates are used as a template for registering a graph of the monitored.

2. Edit the template you created

  And the modification of graph templates created by the case. The size of the graph, color scheme, item name of the graph Y-axis, and change the scale, such as automatic adjustment options.

3. Cacti graph registration

  Select the chart template to register the graph.

4. confirmation of the graph that has been registered

  Check the graph registration result, if by then modify the graph settings.

Template task of creating 1, 2, is carried out only the first time, then the graph of registration of each monitored and used as a template the template that you created. Work of 1 and 3 will use the ** cacti-cli ** command.
Work of 2 and 4 is done by opening the Cacti management screen from the Web browser.

Linux, Windows, the graph templates of basic resources of UNIX to be installed in the Cacti repository DB by default during the site initialization, you do not need to create a new template.

Graph definition file structure
----------------------

** Cacit-cli ** command is run under the home directory of the site, use the following files under the site home directory.

1. lib / graph / {domain name} / {metric name} .json

  Graph definition file. Graph templates, becomes a file that defines the creation rules of graph entity, one of the definition files exist for one metric.

2. lib / graph / color / default.json

  Color scheme list file of the graph. It will be the color scheme list at the time of the legend creating graph templates. The default can be next to default.json, cacti-cli --color-scheme = {color scheme list name} in the option, to specify a {color scheme list name} .json of alias.

3. node / {domain name} / {node name} / {metric name} .json

  Node definition file. Becomes a metric definition file of the monitored node, it is automatically generated at the time of collecting data from the agent counting has been completed. When the graph registration, specify this definition file to ** cacti-cli ** command.

Search rules of definition file at the time of the graph registration, domain name from the path name of the node definition file, extracts the metric name, you read the relevant graph definition file.

Graph template pattern
--------------------------

Layout pattern of the graph becomes the following three types, and then select one. These are described in the graph definition file as a rule.

- Single

  In the most simple layout, such as the CPU utilization of the server, and then used to create one of the graph for one metric

- Single Device

  Disk, used when you have multiple devices to the network, such as one of the metric. Create one graph for each device

- Multi-device

  It used to register more than one metric and devices in one graph. Enumerating several device as a legend to create a single graph

Cacti repository of data model
-----------------------------

Model of Cacti repository DB in the template will be following.

.. Figure :: ../image/cacti_template.png
   : Align: center
   : Alt: Cacti Template

   Cacti Template

- Host Template

  It will enclose the definition of more than one graph templates, usually the same name as the domain name. Linux in the default host template, there is a Windows template, it has been installed at the time of site initialization.

- Graph Template

  The definition of the graph layout in Cacti menu arrangement of the size of the graph, the graph title, legend of comments, you define the threshold, such as. More than one graph templates exist for one metric.

- Data source templates

  In legend definition of the graph, multiple data sources exist for one graph templates. The data source has become a data source name and a pair of RRDtool.

Both in the ** cacti-cli --generate = {graph definition file} ** command, will be automatically generated by the specified graph-defined rules.
