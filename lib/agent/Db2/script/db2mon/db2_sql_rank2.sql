select 
    stmtid,
    member,
    PACKAGE_SCHEMA,
    PACKAGE_NAME,
    EFFECTIVE_ISOLATION,
    PLANID,
    STMT_TYPE_ID,
    to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') as current_time,

    max(to_char(LAST_METRICS_UPDATE,'YYYY-MM-DD HH24:MI:SS')) as last_update,
    sum(NUM_EXECUTIONS) as NUM_EXECUTIONS,
    sum(NUM_EXEC_WITH_METRICS) as NUM_EXEC_WITH_METRICS,
    sum(PREP_TIME) as PREP_TIME,
    sum(TOTAL_ACT_TIME) as TOTAL_ACT_TIME,
    sum(TOTAL_ACT_WAIT_TIME) as TOTAL_ACT_WAIT_TIME,
    sum(TOTAL_CPU_TIME) as TOTAL_CPU_TIME,
    sum(POOL_READ_TIME) as POOL_READ_TIME,
    sum(POOL_WRITE_TIME) as POOL_WRITE_TIME,
    sum(DIRECT_READ_TIME) as DIRECT_READ_TIME,
    sum(DIRECT_WRITE_TIME) as DIRECT_WRITE_TIME,
    sum(LOCK_WAIT_TIME) as LOCK_WAIT_TIME,
    sum(TOTAL_SECTION_SORT_TIME) as TOTAL_SECTION_SORT_TIME,
    sum(TOTAL_SECTION_SORT_PROC_TIME) as TOTAL_SECTION_SORT_PROC_TIME,
    -- sum(TOTAL_SECTION_SORTS) as TOTAL_SECTION_SORTS,
    sum(LOCK_ESCALS) as LOCK_ESCALS,
    sum(LOCK_WAITS) as LOCK_WAITS,
    sum(ROWS_MODIFIED) as ROWS_MODIFIED,
    sum(ROWS_READ) as ROWS_READ,
    sum(ROWS_RETURNED) as ROWS_RETURNED,
    sum(DIRECT_READS) as DIRECT_READS,
    sum(DIRECT_READ_REQS) as DIRECT_READ_REQS,
    sum(DIRECT_WRITES) as DIRECT_WRITES,
    sum(DIRECT_WRITE_REQS) as DIRECT_WRITE_REQS,
    sum(POOL_DATA_L_READS) as POOL_DATA_L_READS,
    sum(POOL_TEMP_DATA_L_READS) as POOL_TEMP_DATA_L_READS,
    sum(POOL_XDA_L_READS) as POOL_XDA_L_READS,
    sum(POOL_TEMP_XDA_L_READS) as POOL_TEMP_XDA_L_READS,
    sum(POOL_INDEX_L_READS) as POOL_INDEX_L_READS,
    sum(POOL_TEMP_INDEX_L_READS) as POOL_TEMP_INDEX_L_READS,
    sum(POOL_DATA_P_READS) as POOL_DATA_P_READS,
    sum(POOL_TEMP_DATA_P_READS) as POOL_TEMP_DATA_P_READS,
    sum(POOL_XDA_P_READS) as POOL_XDA_P_READS,
    sum(POOL_TEMP_XDA_P_READS) as POOL_TEMP_XDA_P_READS,
    sum(POOL_INDEX_P_READS) as POOL_INDEX_P_READS,
    sum(POOL_TEMP_INDEX_P_READS) as POOL_TEMP_INDEX_P_READS,
    sum(POOL_DATA_WRITES) as POOL_DATA_WRITES,
    sum(POOL_XDA_WRITES) as POOL_XDA_WRITES,
    sum(POOL_INDEX_WRITES) as POOL_INDEX_WRITES,
    sum(DEADLOCKS) as DEADLOCKS,
    sum(FCM_RECV_WAIT_TIME) as FCM_RECV_WAIT_TIME,
    sum(FCM_SEND_WAIT_TIME) as FCM_SEND_WAIT_TIME,
    sum(LOCK_TIMEOUTS) as LOCK_TIMEOUTS,
    sum(LOG_BUFFER_WAIT_TIME) as LOG_BUFFER_WAIT_TIME,
    sum(LOG_DISK_WAIT_TIME) as LOG_DISK_WAIT_TIME,
    sum(LOG_DISK_WAITS_TOTAL) as LOG_DISK_WAITS_TOTAL,
    sum(NUM_COORD_EXEC) as NUM_COORD_EXEC,
    sum(NUM_COORD_EXEC_WITH_METRICS) as NUM_COORD_EXEC_WITH_METRICS,
    sum(TOTAL_ROUTINE_TIME) as TOTAL_ROUTINE_TIME,
    sum(QUERY_COST_ESTIMATE) as QUERY_COST_ESTIMATE,
    sum(COORD_STMT_EXEC_TIME) as COORD_STMT_EXEC_TIME,
    sum(STMT_EXEC_TIME) as STMT_EXEC_TIME,
    sum(TOTAL_SECTION_TIME) as TOTAL_SECTION_TIME,
    sum(TOTAL_SECTION_PROC_TIME) as TOTAL_SECTION_PROC_TIME,
    sum(TOTAL_ROUTINE_NON_SECT_TIME) as TOTAL_ROUTINE_NON_SECT_TIME,
    sum(TOTAL_ROUTINE_NON_SECT_PROC_TIME) as TOTAL_ROUTINE_NON_SECT_PROC_TIME,
    sum(LOCK_WAITS_GLOBAL) as LOCK_WAITS_GLOBAL,
    sum(LOCK_WAIT_TIME_GLOBAL) as LOCK_WAIT_TIME_GLOBAL,
    sum(LOCK_TIMEOUTS_GLOBAL) as LOCK_TIMEOUTS_GLOBAL,
    sum(LOCK_ESCALS_MAXLOCKS) as LOCK_ESCALS_MAXLOCKS,
    sum(LOCK_ESCALS_LOCKLIST) as LOCK_ESCALS_LOCKLIST,
    sum(LOCK_ESCALS_GLOBAL) as LOCK_ESCALS_GLOBAL,
    sum(RECLAIM_WAIT_TIME) as RECLAIM_WAIT_TIME,
    sum(SPACEMAPPAGE_RECLAIM_WAIT_TIME) as SPACEMAPPAGE_RECLAIM_WAIT_TIME,
    sum(CF_WAITS) as CF_WAITS,
    sum(CF_WAIT_TIME)  as CF_WAIT_TIME,
    sum(POOL_DATA_GBP_L_READS) as POOL_DATA_GBP_L_READS,
    sum(POOL_DATA_GBP_P_READS) as POOL_DATA_GBP_P_READS,
    sum(POOL_DATA_LBP_PAGES_FOUND) as POOL_DATA_LBP_PAGES_FOUND,
    sum(POOL_DATA_GBP_INVALID_PAGES) as POOL_DATA_GBP_INVALID_PAGES,
    sum(POOL_INDEX_GBP_L_READS) as POOL_INDEX_GBP_L_READS,
    sum(POOL_INDEX_GBP_P_READS) as POOL_INDEX_GBP_P_READS,
    sum(POOL_INDEX_LBP_PAGES_FOUND)  as POOL_INDEX_LBP_PAGES_FOUND,
    sum(POOL_INDEX_GBP_INVALID_PAGES) as POOL_INDEX_GBP_INVALID_PAGES,
    sum(POOL_XDA_GBP_L_READS) as POOL_XDA_GBP_L_READS,
    sum(POOL_XDA_GBP_P_READS) as POOL_XDA_GBP_P_READS,
    sum(POOL_XDA_LBP_PAGES_FOUND) as POOL_XDA_LBP_PAGES_FOUND,
    sum(POOL_XDA_GBP_INVALID_PAGES) as POOL_XDA_GBP_INVALID_PAGES,
    -- sum(AUDIT_FILE_WRITE_WAIT_TIME) as AUDIT_FILE_WRITE_WAIT_TIME,
    -- sum(AUDIT_SUBSYSTEM_WAIT_TIME) as AUDIT_SUBSYSTEM_WAIT_TIME,
    sum(DIAGLOG_WRITE_WAIT_TIME) as DIAGLOG_WRITE_WAIT_TIME,
    sum(FCM_MESSAGE_RECV_WAIT_TIME) as FCM_MESSAGE_RECV_WAIT_TIME,
    sum(FCM_MESSAGE_SEND_WAIT_TIME) as FCM_MESSAGE_SEND_WAIT_TIME,
    sum(FCM_TQ_RECV_WAIT_TIME) as FCM_TQ_RECV_WAIT_TIME,
    sum(FCM_TQ_SEND_WAIT_TIME) as FCM_TQ_SEND_WAIT_TIME,
    -- sum(EVMON_WAIT_TIME) as EVMON_WAIT_TIME,
    sum(TOTAL_EXTENDED_LATCH_WAIT_TIME) as TOTAL_EXTENDED_LATCH_WAIT_TIME,
    sum(TOTAL_EXTENDED_LATCH_WAITS) as TOTAL_EXTENDED_LATCH_WAITS,
    sum(MAX_COORD_STMT_EXEC_TIME) as MAX_COORD_STMT_EXEC_TIME,
    -- sum(TOTAL_DISP_RUN_QUEUE_TIME) as TOTAL_DISP_RUN_QUEUE_TIME,
    -- sum(TOTAL_STATS_FABRICATION_TIME) as TOTAL_STATS_FABRICATION_TIME,
    -- sum(TOTAL_SYNC_RUNSTATS_TIME) as TOTAL_SYNC_RUNSTATS_TIME,
    sum(PREFETCH_WAIT_TIME) as PREFETCH_WAIT_TIME,
    sum(ROWS_DELETED) as ROWS_DELETED,
    sum(ROWS_INSERTED) as ROWS_INSERTED,
    sum(ROWS_UPDATED) as ROWS_UPDATED,
    sum(TOTAL_INDEX_BUILD_TIME) as TOTAL_INDEX_BUILD_TIME,
    sum(LOB_PREFETCH_WAIT_TIME) as LOB_PREFETCH_WAIT_TIME,
    sum(FED_ROWS_DELETED) as FED_ROWS_DELETED,
    sum(FED_ROWS_INSERTED) as FED_ROWS_INSERTED,
    sum(FED_ROWS_UPDATED) as FED_ROWS_UPDATED,
    sum(FED_ROWS_READ) as FED_ROWS_READ,
    sum(FED_WAIT_TIME) as FED_WAIT_TIME,
    sum(FED_WAITS_TOTAL) as FED_WAITS_TOTAL
from
    table(mon_get_pkg_cache_stmt( null, null, null, -2)) as t
where
    t.num_exec_with_metrics <> 0
group by
    stmtid,
    member,
    PACKAGE_SCHEMA,
    PACKAGE_NAME,
    EFFECTIVE_ISOLATION,
    PLANID,
    STMT_TYPE_ID,
    current_time
;
